<!DOCTYPE html>

<html>

<head>

    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>


</head>

<body>

    <!-- <script src="find_path.js"></script> -->

    <script>

        var config = {
            type: Phaser.AUTO,
            width: 1920,
            height: 1920,
            physics: {
                default: 'arcade',
            },

            scene: {
                preload: preload,
                create: create,
                update: update,
            }

        };

        var game = new Phaser.Game(config);

        //Game Objects
        var map;
        var player;
        var mark;

        //Keyboard controls
        var cursors;
        var keys;
        var space;
        var enemies = [];
        var room2left;
        var room2right;
        var jump_number;
        var graphics;

        var gun_type = "machine";
        var shoot_cool_down = true;
        var shooting_state = false;
        var switch_cool_down = true;

        var map;
        var tileset;
        var layer;
        var layer_1;
        var layer_2;
        var layer_3;
        var layer_4;

        var current_level = 1;
        var map3;
        var layer_3_1;
        var layer_3_2;
        var layer_3_3;
        var layer_3_4;

        function GameScene() {
            Phaser.Scene.call(this, { key: 'GameScene' });
        }

        function preload() {
            this.load.image('sky', 'assets/deepblue.png');
            this.load.image('missile', 'assets/missile.png');
            this.load.image('enemymissile', 'assets/14.png');
            this.load.image('mark', 'assets/target.png');
            this.load.atlas('cube', 'assets/cubespritesheet.png', 'assets/cubespritesheet.json');
            this.load.atlas('enemy_1', 'assets/enemy_1.png', 'assets/enemy_1.json');
            this.load.atlas('explosion', 'assets/explosion.png', 'assets/explosion.json')
            this.load.image('factorytiles', 'factorytileset.png');
            this.load.image('scifitiles', 'scifitileset.png');
            this.load.image('health', 'assets/health.png');
            this.load.tilemapTiledJSON('tilemap', 'assets/maponev6.json');

            this.load.image('dungeontileset', 'map3/dungeontileset.png');
            this.load.image('greydungeontileset', 'map3/greydungeontileset.png');
            this.load.tilemapTiledJSON('tilemap3', 'map3/map3v2.json');

            this.load.image('factorytiles', 'factorytileset.png');
            this.load.image('scifitiles', 'scifitileset.png');

        }
        function level_1(scene)
        {
            // set_map
            map = scene.make.tilemap({ key: 'tilemap' });
            var tileset_1 = map.addTilesetImage('factorytileset', 'factorytiles');
            var tileset_2 = map.addTilesetImage('scifitileset', 'scifitiles');

            layer_1 = map.createStaticLayer('floorscifi', tileset_2);
            layer_3 = map.createStaticLayer('floorfactory', tileset_1);
            layer_2 = map.createStaticLayer('wallsscifi', tileset_2);
            layer_4 = map.createStaticLayer('wallsfactory', tileset_1);

            layer_2.setCollisionByExclusion([-1]);
            layer_4.setCollisionByExclusion([-1]);

            // shoot mark and player
            mark = new Mark(scene, 0, 0, 'mark');

            let playerAnimations = {};
            var idle = scene.anims.create({ key: 'cube_idle', frames: scene.anims.generateFrameNames('cube', { prefix: 'Idle_', end: 6, zeroPad: 1 }), repeat: -1, frameRate: 6 });
            playerAnimations['idle'] = idle;
            var left = scene.anims.create({ key: 'cube_left', frames: scene.anims.generateFrameNames('cube', { prefix: 'Left_', end: 6, zeroPad: 1 }), repeat: -1, frameRate: 6 });
            playerAnimations['left'] = left;
            var right = scene.anims.create({ key: 'cube_right', frames: scene.anims.generateFrameNames('cube', { prefix: 'Right_', end: 6, zeroPad: 1 }), repeat: -1, frameRate: 6 });
            playerAnimations['right'] = right;

            mark = new Mark(scene, 0, 0, 'mark');
            player = new Player(scene, 352, 640, 'cube', playerAnimations);
            scene.physics.add.collider(player, layer_2);
            scene.physics.add.collider(player, layer_4);
            player.play(player.animations['idle']);

            // enemy
            let enemy_1_Animations = {};
            var idle = scene.anims.create({ key: 'enemy_1_idle', frames: scene.anims.generateFrameNames('enemy_1', { prefix: 'mech-unit-export', end: 7, zeroPad: 1 }), repeat: -1, frameRate: 6 });
            var death = scene.anims.create({ key: 'death', frames: scene.anims.generateFrameNames('explosion', { prefix: 'explosion-animation', end: 9, zeroPad: 1}), repeat: -1, frameRate: 6 });
            enemy_1_Animations['idle'] = idle;
            enemy_1_Animations['death'] = death;

            room2right = new Enemy(scene, 480, 1408, 'enemy_1', enemy_1_Animations);
            enemies.push(room2right);
            room2right.play(room2right.animations['idle']);
            navigate(scene, player, room2right);

            room2left = new Enemy(scene, 192, 1408, 'enemy_1', enemy_1_Animations);
            enemies.push(room2left);
            room2left.play(room2left.animations['idle']);
            navigate(scene, player, room2left);

            room3right = new Enemy(scene, 787, 1607, 'enemy_1', enemy_1_Animations);
            enemies.push(room3right);
            room3right.play(room3right.animations['idle']);
            navigate(scene, player, room3right);

            room3left = new Enemy(scene, 1092, 1620, 'enemy_1', enemy_1_Animations);
            enemies.push(room3left);
            room3left.play(room2left.animations['idle']);
            navigate(scene, player, room3left);

            room4right = new Enemy(scene, 1690, 1113, 'enemy_1', enemy_1_Animations);
            enemies.push(room4right);
            room4right.play(room4right.animations['idle']);
            navigate(scene, player, room4right);

            room4left = new Enemy(scene, 1671, 1408, 'enemy_1', enemy_1_Animations);
            enemies.push(room4left);
            room4left.play(room4left.animations['idle']);
            navigate(scene, player, room4left);
        }

        function level_2(scene)
        {
            
            // set_map
            layer_1.destroy();
            layer_2.destroy();
            layer_3.destroy();
            layer_4.destroy();

            map = scene.make.tilemap({ key: 'tilemap3' });
            var tileset_1 = map.addTilesetImage('factorytileset', 'factorytiles');
            var tileset_2 = map.addTilesetImage('scifitileset', 'scifitiles');
            var tileset_3 = map.addTilesetImage('dungeontileset', 'dungeon tiles');

            layer_1 = map.createStaticLayer('purplefloor', tileset_3);
            layer_3 = map.createStaticLayer('greyfloor', tileset_1);
            layer_2 = map.createStaticLayer('scifiwalls', tileset_2);
            layer_4 = map.createStaticLayer('purplewalls', tileset_3);

            layer_2.setCollisionByExclusion([-1]);
            layer_4.setCollisionByExclusion([-1]);

            // shoot mark and player
            mark = new Mark(scene, 0, 0, 'mark');
            let playerAnimations = {};
            var idle = scene.anims.create({ key: 'cube_idle', frames: scene.anims.generateFrameNames('cube', { prefix: 'Idle_', end: 6, zeroPad: 1 }), repeat: -1, frameRate: 6 });
            playerAnimations['idle'] = idle;
            var left = scene.anims.create({ key: 'cube_left', frames: scene.anims.generateFrameNames('cube', { prefix: 'Left_', end: 6, zeroPad: 1 }), repeat: -1, frameRate: 6 });
            playerAnimations['left'] = left;
            var right = scene.anims.create({ key: 'cube_right', frames: scene.anims.generateFrameNames('cube', { prefix: 'Right_', end: 6, zeroPad: 1 }), repeat: -1, frameRate: 6 });
            playerAnimations['right'] = right;

            mark = new Mark(scene, 0, 0, 'mark');
            player = new Player(scene, 352, 640, 'cube', playerAnimations);
            scene.physics.add.collider(player, layer_2);
            scene.physics.add.collider(player, layer_4);
            player.play(player.animations['idle']);

            // enemy
            let enemy_1_Animations = {};
            var idle = scene.anims.create({ key: 'enemy_1_idle', frames: scene.anims.generateFrameNames('enemy_1', { prefix: 'mech-unit-export', end: 7, zeroPad: 1 }), repeat: -1, frameRate: 6 });
            var death = scene.anims.create({ key: 'death', frames: scene.anims.generateFrameNames('explosion', { prefix: 'explosion-animation', end: 9, zeroPad: 1}), repeat: -1, frameRate: 6 });
            enemy_1_Animations['idle'] = idle;
            enemy_1_Animations['death'] = death;

            room2right = new Enemy(scene, 480, 1408, 'enemy_1', enemy_1_Animations);
            enemies.push(room2right);
            room2right.play(room2right.animations['idle']);
            navigate(scene, player, room2right);

            room2left = new Enemy(scene, 192, 1408, 'enemy_1', enemy_1_Animations);
            enemies.push(room2left);
            room2left.play(room2left.animations['idle']);
            navigate(scene, player, room2left);

            room3right = new Enemy(scene, 787, 1607, 'enemy_1', enemy_1_Animations);
            enemies.push(room3right);
            room3right.play(room3right.animations['idle']);
            navigate(scene, player, room3right);

            room3left = new Enemy(scene, 1092, 1620, 'enemy_1', enemy_1_Animations);
            enemies.push(room3left);
            room3left.play(room2left.animations['idle']);
            navigate(scene, player, room3left);

            room4right = new Enemy(scene, 1690, 1113, 'enemy_1', enemy_1_Animations);
            enemies.push(room4right);
            room4right.play(room4right.animations['idle']);
            navigate(scene, player, room4right);

            room4left = new Enemy(scene, 1671, 1408, 'enemy_1', enemy_1_Animations);
            enemies.push(room4left);
            room4left.play(room4left.animations['idle']);
            navigate(scene, player, room4left);
        }

        function create() {
            this.cameras.main.setZoom(1.75);

            level_1(this);
            //Set up user input
            cursors = this.input.keyboard.createCursorKeys();
            keys = this.input.keyboard.addKeys('A, D, W, S, Q');


            this.input.on('pointermove', function (pointer) {
                mark.x = pointer.worldX;
                mark.y = pointer.worldY;
            }, this);

            this.input.on('pointerdown', function (pointer) {
                if (gun_type === "machine")
                    shooting_state = true;
                else if (gun_type === "shotgun") {
                  if (shoot_cool_down)
                  {
                    angle = Phaser.Math.Angle.Between(player.x, player.y, mark.x, mark.y);
                    var bullet;
                    bullet = new Bullet(this, player.x, player.y, 'missile', angle);
                    this.physics.add.overlap(bullet, enemies, bullet_hit, null, this);
                    this.physics.add.collider(bullet, layer_2, bullet_hit_wall, null, this);

                    bullet = new Bullet(this, player.x, player.y, 'missile', angle + 15 / 180 * Math.PI);
                    this.physics.add.overlap(bullet, enemies, bullet_hit, null, this);
                    this.physics.add.collider(bullet, layer_2, bullet_hit_wall, null, this);

                    bullet = new Bullet(this, player.x, player.y, 'missile', angle - 15 / 180 * Math.PI);
                    this.physics.add.overlap(bullet, enemies, bullet_hit, null, this);
                    this.physics.add.collider(bullet, layer_2, bullet_hit_wall, null, this);

                    shoot_cool_down = false;
                    this.time.delayedCall(200, cool_down, [], this);
                  }
                }
            }, this);

            this.input.on('pointerup', function (pointer) {
                shooting_state = false;
            }, this);

            graphics = this.add.graphics();
        }

        function update() {
            player.setDragX(1500);

            var x = player.x
            var y = player.y
            player.health_bar.x = x - 1;
            player.health_bar.y = y - 25;
            player.health_bar.width = player.health*1;

            //Handle player movements
            var i = 0;
            if (cursors.left.isDown || keys.A.isDown) {
                i = 1
                player.setVelocityX(-200);
                player.play(player.animations['left'], true);
            }
            else if (cursors.right.isDown || keys.D.isDown) {
                i = 1
                player.setVelocityX(200);
                player.play(player.animations['right'], true);
            }

            if (keys.W.isDown) {
                i = 1
                player.setVelocityY(-200);
            }
            else if (keys.S.isDown) {
                i = 1
                player.setVelocityY(200);
            }

            if (i === 0) {
                player.setVelocityY(0);
                player.setVelocityX(0);
                player.play(player.animations['idle'], true);
            }

            if (keys.Q.isDown && switch_cool_down) {
                switch_cool_down = false;
                this.time.delayedCall(1000, s_cool_down, [], this);
                if (gun_type === "machine")
                    gun_type = "shotgun";
                else
                    gun_type = "machine";
            }

            this.cameras.main.centerOn(player.x, player.y);

            if(enemies.length === 0)
            {
                if(current_level === 1)
                {
                    level_2(this);
                }
            }
            for (var i = 0; i < enemies.length; i++) {
                var enemy = enemies[i];
                if (enemy) {
                    var x = enemy.x
                    var y = enemy.y
                    enemy.health_bar.x = x - 1;
                    enemy.health_bar.y = y - 25;
                    enemy.health_bar.width = enemy.health*1;
                    var distance = Math.sqrt((enemy.x - player.x) ** 2 + (enemy.y - player.y) ** 2);
                    if (enemy.path.length > 0 && distance > 100 && distance < 700) {
                        var current = [Math.round(enemy.x / 32), Math.round(enemy.y / 32)];
                        var target = enemy.path[enemy.path.length - 1];
                        if (current[1] === target[0] && current[0] === target[1]) {
                            enemy.path.pop();
                        }
                        var angle = Phaser.Math.Angle.Between(enemy.x, enemy.y, target[1] * 32, target[0] * 32);
                        enemy.setVelocityX(200 * Math.cos(angle));
                        enemy.setVelocityY(200 * Math.sin(angle));
                        if (enemy.health < 0) {
                            enemy.play(enemy.animations['death']);
                            this.time.delayedCall(1000, destroy, [enemy], this);
                            enemy.setVelocityX(0);
                            enemy.setVelocityY(0);
                            enemies.splice(enemies.indexOf(enemy), 1);
                        }
                    }
                    else {
                        if (distance < 100 && enemy.cool_down) {
                            enemy.cool_down = false;
                            this.time.delayedCall(500, enemy_cool_down, [enemy], this);
                            angle = Phaser.Math.Angle.Between(enemy.x, enemy.y, player.x, player.y);
                            var bullet;
                            bullet = new Bullet(this, enemy.x, enemy.y, 'enemymissile', angle);
                            this.physics.add.overlap(bullet, player, bullet_hit, null, this);
                            this.physics.add.collider(bullet, layer_2, bullet_hit_wall, null, this);
                        }
                        enemy.setVelocityX(0);
                        enemy.setVelocityY(0);
                        if (enemy.health < 0) {
                            enemy.health_bar.width = 0;
                            enemy.play(enemy.animations['death']);
                            this.time.delayedCall(1000, destroy, [enemy], this);
                            enemies.splice(enemies.indexOf(enemy), 1);
                        }
                    }
                }
            }
            if (shooting_state) {
                if (shoot_cool_down && gun_type == "machine") {
                    angle = Phaser.Math.Angle.Between(player.x, player.y, mark.x, mark.y);
                    var bullet;
                    bullet = new Bullet(this, player.x, player.y, 'missile', angle);
                    shoot_cool_down = false;
                    this.time.delayedCall(100, cool_down, [], this);
                    this.physics.add.overlap(bullet, enemies, bullet_hit, null, this);
                    this.physics.add.collider(bullet, layer_2, bullet_hit_wall, null, this);
                }
            }
        }

        function destroy(enemy) {
            enemy.destroy();
        }

        function enemy_cool_down(enemy) {
            enemy.cool_down = true;
        }

        function cool_down() {
            shoot_cool_down = true;
        }

        function s_cool_down() {
            switch_cool_down = true;
        }

        function jump(event) {
            if (jump_number > 0) {
                jump_number = jump_number - 1;
                player.setVelocityY(-700);
            }
        }

        class Bullet extends Phaser.Physics.Arcade.Sprite {
            constructor(scene, x, y, spritesheet, angle) {
                super(scene, x, y, spritesheet);
                scene.add.existing(this);
                scene.physics.add.existing(this);
                this.setAngle(angle * (180 / Math.PI));
                this.setScale(0.1);
                this.setVelocityX(700 * Math.cos(angle));
                this.setVelocityY(700 * Math.sin(angle));
            }
        }

        class Mark extends Phaser.Physics.Arcade.Sprite {
            constructor(scene, x, y, spritesheet) {
                super(scene, x, y, spritesheet);
                scene.add.existing(this);
                this.setScale(0.7);
            }
        }

        function bullet_hit(obj1, obj2) {
            obj1.destroy();
            obj2.damage(1);
        }

        function bullet_hit_wall(obj1, obj2) {
            obj1.destroy();
        }

        class Player extends Phaser.Physics.Arcade.Sprite {
            animations;
            constructor(scene, x, y, spritesheet, animations) {
                super(scene, x, y, spritesheet);
                this.health = 30;
                this.animations = animations;
                scene.add.existing(this);
                scene.physics.add.existing(this);
                this.setScale(0.8);
                this.setCollideWorldBounds(true);
                this.health_bar = scene.add.rectangle(x - 5, y - 25, this.health*1, 1, 0x9966ff);
            }

            damage(damage) {
                this.health -= damage;
                if (this.health < 0) {
                    this.destroy();
                }
            }
        }

        class Enemy extends Phaser.Physics.Arcade.Sprite {
            constructor(scene, x, y, spritesheet, animation) {
                super(scene, x, y, spritesheet, animation);
                this.animations = animation;
                this.path = [];
                this.health = 1;
                this.cool_down = true;
                scene.add.existing(this);
                scene.physics.add.existing(this);
                this.setScale(0.6);
                this.health_bar = scene.add.rectangle(x - 5, y - 25, this.health*1, 1, 0x9966ff);
            }
            addTween(scene, xDist, yDist, time) {
                scene.tweens.add({ targets: this, x: xDist, y: yDist, duration: time, ease: 'Sine.easeInOut', repeat: -1, yoyo: true });
            }
            damage(damage) {
                this.health -= damage;
            }
        }

        function navigate(scene, player, enemy) {
            var start = [Math.round(enemy.y / 32), Math.round(enemy.x / 32)];
            var end = [Math.round(player.y / 32), Math.round(player.x / 32)];
            enemy.path = find_path(start, end);
            scene.time.delayedCall(2000, navigate, [scene, player, enemy], scene);
        }

        function find_path(start, end) {
            var data = [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 2, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 77, 0, 0, 0, 0, 0, 0, 109, 110, 111, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 77, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 114, 0, 0, 0, 0, 0, 0, 146, 147, 148, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 114, 0, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 183, 184, 185, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 147, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 184, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 111, 111, 111, 109, 110, 111, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 148, 148, 148, 146, 147, 148, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 109, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 146, 147, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 299, 0, 0, 0, 0, 0, 0, 0, 0, 0, 305, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 299, 0, 109, 110, 0, 0, 0, 0, 0, 0, 305, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 46, 335, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 343, 41, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46, 335, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 343, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 46, 373, 374, 374, 374, 47, 0, 0, 39, 374, 374, 379, 378, 41, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 372, 373, 374, 374, 374, 374, 374, 374, 374, 47, 0, 0, 39, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 337, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 337, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 337, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 337, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 337, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 337, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 2, 3, 6, 6, 6, 6, 0, 0, 6, 6, 6, 6, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 6, 0, 0, 6, 6, 6, 6, 6, 6, 6, 9, 10, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 47, 0, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 77, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 39, 6, 6, 6, 6, 7, 0, 0, 0, 0, 0, 0, 0, 84, 0, 77, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 114, 0, 0, 0, 0, 0, 0, 0, 109, 110, 111, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 84, 0, 114, 0, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 146, 147, 148, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 147, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 146, 147, 147, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 47, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 184, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 146, 147, 147, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 109, 110, 111, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 2, 3, 6, 6, 0, 0, 0, 0, 0, 0, 0, 6, 9, 10, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 147, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 146, 147, 148, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 39, 0, 0, 0, 0, 109, 110, 111, 111, 0, 0, 0, 0, 47, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 184, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 183, 184, 185, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 6, 6, 6, 0, 77, 0, 0, 0, 146, 147, 148, 148, 0, 0, 0, 0, 0, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 109, 110, 111, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 146, 147, 148, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 84, 0, 299, 0, 0, 0, 0, 0, 0, 0, 0, 0, 305, 0, 0, 376, 376, 376, 376, 376, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 376, 376, 376, 376, 0, 299, 0, 0, 0, 0, 0, 0, 0, 0, 0, 305, 0, 0, 76, 0, 0, 0, 0],
            [0, 0, 0, 46, 335, 336, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 342, 343, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 335, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 343, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 372, 373, 374, 298, 299, 0, 0, 0, 0, 342, 374, 379, 378, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110, 0, 0, 76, 0, 0, 0, 372, 373, 374, 374, 374, 374, 374, 374, 374, 374, 374, 379, 378, 41, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 335, 376, 376, 376, 376, 376, 379, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 147, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 184, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 109, 110, 111, 111, 111, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 146, 147, 148, 148, 148, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84, 0, 299, 0, 0, 0, 0, 0, 0, 0, 0, 0, 305, 0, 0, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46, 335, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 343, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 372, 373, 374, 374, 374, 374, 374, 374, 374, 374, 374, 379, 378, 41, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
            var s = start[0] + " " + start[1];
            data[start[0]][start[1]] = 0;

            var come_from = {};
            come_from[s] = [0, 0];

            var front = [];
            front.push(start);

            var found = false;
            while (front.length > 0) {
                pos = front[0];
                x = pos[0];
                y = pos[1];
                if (x != end[0] || y != end[1]) {
                    if (data[x][y] === 0) {
                        var r_list = [1, 2, 3, 4];
                        for (var z = 0; z < 4; z++) {
                            let r = Math.floor(Math.random() * r_list.length);
                            var random_dir = r_list[r];
                            r_list.splice(r, 1);
                            if (random_dir === 1) {
                                var s = (x - 1) + " " + y;
                                if (x > 0 && !come_from.hasOwnProperty(s)) {
                                    come_from[s] = [x, y];
                                    front.push([x - 1, y])
                                }
                            }
                            else if (random_dir === 2) {
                                var s = (x + 1) + " " + y;
                                if (x < data.length - 1 && !come_from.hasOwnProperty(s)) {
                                    come_from[s] = [x, y];
                                    front.push([x + 1, y])
                                }
                            }
                            else if (random_dir === 3) {
                                var s = x + " " + (y - 1);
                                if (y > 0 && !come_from.hasOwnProperty(s)) {
                                    come_from[s] = [x, y];
                                    front.push([x, y - 1]);
                                }
                            }
                            else {
                                var s = x + " " + (y + 1);
                                if (y < data[0].length - 1 && !come_from.hasOwnProperty(s)) {
                                    come_from[s] = [x, y];
                                    front.push([x, y + 1]);
                                }
                            }
                        }
                    }
                }
                else {
                    found = true;
                    break;
                }
                front.shift();
            }

            var path = [];
            if (found) {
                let current_x = end[0];
                let current_y = end[1];

                let target_x = start[0];
                let target_y = start[1];
                while (current_x != target_x || current_y != target_y) {
                    path.push([current_x, current_y]);
                    data[current_x][current_y] = "*";
                    var from = come_from[current_x + " " + current_y];
                    current_x = from[0];
                    current_y = from[1];
                }
            }
            return path;
        }

    </script>
</body>

</html>
